% Images
\pgfdeclareimage[width=10cm]{ROSEquation}{./images/ros_equation_2}
\pgfdeclareimage[width=10cm]{gazebo}{./images/gazebo_horz_cmyk_pos.jpg}
\pgfdeclareimage[width=10cm]{opencv}{./images/opencv_logo.png}
\pgfdeclareimage[width=10cm]{pcl}{./images/pointcloudlibrary_horz_large_pos.jpg}
\pgfdeclareimage[width=10cm]{moveit}{./images/moveit-logo.png}

% Tikz libraries
\usetikzlibrary{shadows}
\usetikzlibrary{automata}
\usetikzlibrary{arrows}

% For arrows
\definecolor{darkblue}{rgb}{0.2,0.2,0.6}
\definecolor{darkred}{rgb}{0.6,0.1,0.1}
\definecolor{darkgreen}{rgb}{0.2,0.6,0.2}

\def\arrowt{
  (0.1,0.5) -- (0.0,1) -- (6.0,1.0) [rounded corners=0.5] --
  (6.0,1.5) [rounded corners=1] -- (7.0,0.5) [rounded corners=0.5] --
  (6.0,-0.5) [sharp corners] -- (6.0,0.0) -- (0.0,0.0)
  [rounded corners=1] -- (0.1,0.5) -- cycle
}

\def\arrowd{
  (10.75:1.1) -- (6.5:1) arc (6.25:120:1) [rounded corners=0.5] --
  (120:0.9) [rounded corners=1] -- (130:1.1) [rounded corners=0.5] --
  (120:1.3) [sharp corners] -- (120:1.2) arc (120:5.25:1.2)
  [rounded corners=1] -- (10.75:1.1) -- (6.5:1) -- cycle
}

\def\arrow{
  (10.75:1.1) -- (6.5:1) arc (6.25:90:1) [rounded corners=0.5] --
  (90:0.9) [rounded corners=1] -- (100:1.1) [rounded corners=0.5] --
  (90:1.3) [sharp corners] -- (90:1.2) arc (90:5.25:1.2)
  [rounded corners=1] -- (10.75:1.1) -- (6.5:1) -- cycle
}

\def\arrowtd{
  (-10.75:1.1) -- (-6.5:1) arc (-6.25:-170:1) [rounded corners=0.5] --
  (-170:0.9) [rounded corners=1] -- (-180:1.1) [rounded corners=0.5] --
  (-170:1.3) [sharp corners] -- (-170:1.2) arc (-170:-5.25:1.2)
  [rounded corners=1] -- (-10.75:1.1) -- (-6.5:1) -- cycle
}

\tikzset{
  ashadow/.style={opacity=.25, shadow xshift=0.07, shadow yshift=-0.07},
}


\def\arrows[#1]{         
  \begin{scope}[scale=#1]
    \draw[color=darkred, %
    drop shadow={ashadow, color=red!60!black}] \arrow;

    %\draw[color=darkgreen, bottom color=green!90!black, top color=green!60, %
    %drop shadow={ashadow, color=green!60!black}] [rotate=120] \arrow;

    %\draw[color=darkblue, right color=blue, left color=blue!60, %
    %drop shadow={ashadow, color=blue!60!black}] [rotate=240] \arrow;

    % to hide the green shadow

  \end{scope}
}

\def\motivationpicture{
  \begin{tikzpicture}[remember picture, overlay]
    %HRP-2
    \node[inner sep=0pt,scale=0.5] (hrp2) at (7.5,-3.0) {%
      \includegraphics[width=3.5cm]{images/PR2-robot.jpeg}%
    };    
    \node[inner sep=0pt,scale=1.1] at (10.0,-3.0) {%
      Environnement
    };
  \end{tikzpicture}
}

\def\motivationgraph{
  \begin{tikzpicture}[remember picture, overlay]
    %
    \draw[color=darkred, left color=red, right color=red!60, 
      xshift=9cm,yshift=-2cm,
      drop shadow={ashadow, color=red!60!black}] 
    \arrow;
    \draw[color=darkblue, right color=blue, left color=blue!60,%
      xshift=9cm,yshift=-3cm, %
      drop shadow={ashadow, color=blue!60!black}]       
     [rotate=260] \arrow;
    %
    % Noeud sur le traitement du signal.
    \node [text centered, text width = 1.75cm, rectangle,draw,fill=blue!50!white] 
    (sensors)
    at (5.5,-0.25) {Traitement\\du signal};
    %
    % Représentation de l'environnement
    \node [text centered, text width = 3.2cm, rectangle,draw,fill=blue!50!white] 
    (worldmap)
    at (2.0,-0.75) {Représentation\\ de l'environnement};
    %
    % Contrôle
    \node [text centered, text width = 1.75cm, rectangle,draw,fill=blue!50!white] 
    (control) 
    at (5.5,-4.9) {Contrôle};    
    %
    % Planification de mouvement
    \node [text centered, text width = 2.5cm, rectangle,draw,fill=blue!50!white] 
    (motionplanning)
    at (2.25,-4.25) {Planification de mouvement};
    %
    % Planification de taches.
    \node [text centered, text width = 2.0cm, rectangle,draw,fill=blue!50!white] 
    (taskplanning)
    at (1,-2.5) {Planification de tâches};          
    %
    % Physical relationship
    \draw[->,>=triangle 60,very thick,color=red] (hrp2) -- (sensors);
    \draw[->,>=triangle 60,very thick,color=red] (control) -- (hrp2);
  \end{tikzpicture}
}

\def\implementationgraph{
 \begin{tikzpicture}[remember picture, overlay]
    \node [text centered, text width = 3cm] 
    at (5.5,0.5) {OpenCV - PCL};

    \node [text centered, text width = 3.2cm] 
    at (2.0,0.0) {OctoMap};

    \node [text centered, text width = 3.5cm] 
    at (5.5,-5.45) {KLD - iTask - SoT};

    \node [text centered, text width = 2.5cm] 
    at (2.25,-5.0) {MovIt};

    \node [text centered, text width = 2.0cm] 
    at (0.25,-3.25) {SMACH};   
 \end{tikzpicture}
}       

\def\deploymentgraph{
 \begin{tikzpicture}[remember picture, overlay]
    \node [text centered, text width = 3cm] 
    at (5.5,0.5) {PC - Vision};

    \node [text centered, text width = 3.2cm] 
    at (2.0,0.0) {PC - Mapping};

    \node [text centered, text width = 3.5cm] 
    at (5.5,-5.45) {PC - Contr\^{o}le};

    \node [text centered, text width = 4.5cm] 
    at (2.25,-5.0) {PC - Motion Planning};

    \node [text centered, text width = 4.5cm] 
    at (1.25,-3.25) {PC - Task Planning};
 \end{tikzpicture}
}


\def\logicalrelationship{
 \begin{tikzpicture}[remember picture, overlay]        
   %
    % Logical relationship
      % Data flow
   \draw[<-,>=triangle 45,>=triangle 45] (control)--(sensors);
   \draw[->,>=triangle 45,>=triangle 45] (motionplanning)--(control); 
   \draw[->,>=triangle 45,>=triangle 45] (sensors)--(worldmap); 
   \draw[->,>=triangle 45,>=triangle 45] (worldmap) to[out=315,in=90] (motionplanning); 
   \draw[<-,>=triangle 45,>=triangle 45] (taskplanning) -- (worldmap);
   \draw[->,>=triangle 45,>=triangle 45] (taskplanning)--(motionplanning);
   \draw[->,>=triangle 45,>=triangle 45] (taskplanning) to[out=0,in=135] (control);
 \end{tikzpicture}
}

\def\softwarerelationship{
 \begin{tikzpicture}[remember picture, overlay]        
    %
    % Software relationship
    % Bus logiciel.
    \node [text centered, text width = 2.0cm, rectangle,draw,fill=blue!20!white] 
    (softwarebus) at (5,-2.5) {Bus logiciel};          
    % 
    % Software bus
    \draw[<->,>=triangle 45,>=triangle 45] (control)--(softwarebus);
    \draw[<->,>=triangle 45,>=triangle 45] (motionplanning) -- (softwarebus); 
    \draw[<->,>=triangle 45,>=triangle 45] (worldmap)--(softwarebus); 
    \draw[<->,>=triangle 45,>=triangle 45] (taskplanning)--(softwarebus);
    \draw[<->,>=triangle 45,>=triangle 45] (sensors)--(softwarebus);
 \end{tikzpicture}
}
 
